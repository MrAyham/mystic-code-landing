<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" /><meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Stage 5 · التتويج</title>
<style>
  html,body{margin:0;height:100%;background:#000;color:#fff;font-family:sans-serif;overflow:hidden}
  #matrix{position:fixed;inset:0;z-index:-2;background:#000;pointer-events:none}
  .wrap{min-height:100vh;display:grid;place-items:center;padding:20px}
  .card{width:min(860px,94vw);text-align:center;background:rgba(255,255,255,.05);
        border:1px solid rgba(255,255,255,.12);border-radius:18px;padding:22px;backdrop-filter:blur(6px)}
  .inp{width:min(420px,90%);padding:10px;border-radius:12px;border:1px solid rgba(255,255,255,.2);background:#121008;color:#fff;text-align:center}
  .btn{display:inline-block;margin-top:10px;padding:10px 16px;border-radius:999px;border:0;background:linear-gradient(90deg,#fde047,#f59e0b);color:#352000}
  .small{opacity:.8;font-size:12px}
</style>
</head>
<body data-matrix-color="#f5c542">
<canvas id="matrix"></canvas>
<div class="wrap"><div class="card">
  <h1>المرحلة الخامسة – التتويج</h1>
  <p class="small">كلمة التتويج = fragment_1 + fragment_2 + RA</p>
  <input id="code" class="inp" placeholder="أدخل كلمة التتويج…" />
  <button class="btn" onclick="check()">افتح النور</button>
  <p id="status"></p>

  <div id="gift" style="display:none;margin-top:10px">
    <h3>النور يُرى ✨</h3>
    <p id="msg"></p>
    <a class="btn" href="#" id="giftLink" target="_blank" rel="noopener">جرّب الهدية</a>
  </div>
</div></div>

<script>
function check(){
  const f1=(localStorage.getItem('mc_f1')||'ARCH').toUpperCase();
  const f2=(localStorage.getItem('mc_f2')||'').toUpperCase();
  const target=(f1 + f2 + 'RA').toUpperCase();
  const val=(document.getElementById('code').value||'').toUpperCase().trim();
  const s=document.getElementById('status');
  if(val===target){
    s.textContent='صحيح. التتويج يفتح.'; s.style.color='#00ff88';
    const name=localStorage.getItem('mystic_name')||'أنت';
    document.getElementById('msg').textContent=`${name}… لقد بلغت السيادة.`;
    document.getElementById('giftLink').href='https://example.com/twin'; // بدّل الرابط
    document.getElementById('gift').style.display='block';
    localStorage.setItem('mc_crowned','1');
  }else{
    s.textContent='ليست هذه الكلمة. أعِد تركيب الأجزاء.'; s.style.color='#ff6b6b';
  }
}
</script>
<script>
(function(){const c=document.getElementById('matrix'),x=c.getContext('2d');
function r(){c.width=innerWidth;c.height=innerHeight}addEventListener('resize',r);r();
const color=document.body.getAttribute('data-matrix-color')||'#f5c542',fs=16,chars='ｱｶｻﾀﾅﾊﾏﾔﾗﾜ0123456789';
let cols=Math.floor(c.width/fs),drops=Array(cols).fill(1);
function d(){x.fillStyle='rgba(0,0,0,0.08)';x.fillRect(0,0,c.width,c.height);
x.fillStyle=color;x.font=fs+'px monospace';for(let i=0;i<drops.length;i++){const t=chars[Math.random()*chars.length|0];
x.fillText(t,i*fs,drops[i]*fs);if(drops[i]*fs>c.height&&Math.random()>0.975)drops[i]=0;drops*
